<% layout('/layouts/boilerplate') %>

<style>
    /* Revolutionary Design System - World-Class Community Platform */
    :root {
        /* Professional Emerald Color System */
        --emerald-50: #ecfdf5;
        --emerald-100: #d1fae5;
        --emerald-200: #a7f3d0;
        --emerald-300: #6ee7b7;
        --emerald-400: #34d399;
        --emerald-500: #10b981;
        --emerald-600: #059669;
        --emerald-700: #047857;
        --emerald-800: #065f46;
        --emerald-900: #064e3b;
        
        /* Advanced Gray Scale */
        --gray-50: #f9fafb;
        --gray-100: #f3f4f6;
        --gray-200: #e5e7eb;
        --gray-300: #d1d5db;
        --gray-400: #9ca3af;
        --gray-500: #6b7280;
        --gray-600: #4b5563;
        --gray-700: #374151;
        --gray-800: #1f2937;
        --gray-900: #111827;
        
        /* Accent Colors */
        --blue-500: #3b82f6;
        --blue-600: #2563eb;
        --purple-500: #8b5cf6;
        --purple-600: #7c3aed;
        --orange-500: #f97316;
        --orange-600: #ea580c;
        --red-500: #ef4444;
        --red-600: #dc2626;
        --yellow-500: #eab308;
        --pink-500: #ec4899;
        
        /* Professional Gradients */
        --gradient-primary: linear-gradient(135deg, var(--emerald-500) 0%, var(--emerald-600) 100%);
        --gradient-secondary: linear-gradient(135deg, var(--emerald-400) 0%, var(--emerald-500) 100%);
        --gradient-hero: linear-gradient(135deg, var(--emerald-600) 0%, var(--emerald-700) 50%, var(--emerald-800) 100%);
        --gradient-surface: linear-gradient(145deg, rgba(255,255,255,0.95) 0%, rgba(255,255,255,0.98) 100%);
        --gradient-glass: linear-gradient(145deg, rgba(255,255,255,0.1) 0%, rgba(255,255,255,0.05) 100%);
        
        /* Advanced Shadows */
        --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
        --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
        --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        --shadow-xl: 0 20px 25px -5px rgb(0 0 0 / 0.1), 0 8px 10px -6px rgb(0 0 0 / 0.1);
        --shadow-2xl: 0 25px 50px -12px rgb(0 0 0 / 0.25);
        --shadow-3xl: 0 35px 60px -12px rgb(0 0 0 / 0.3);
        --shadow-emerald: 0 20px 25px -5px rgb(16 185 129 / 0.4), 0 8px 10px -6px rgb(16 185 129 / 0.3);
        --shadow-glow: 0 0 20px rgb(16 185 129 / 0.3);
        
        /* Typography Scale */
        --text-xs: 0.75rem;
        --text-sm: 0.875rem;
        --text-base: 1rem;
        --text-lg: 1.125rem;
        --text-xl: 1.25rem;
        --text-2xl: 1.5rem;
        --text-3xl: 1.875rem;
        --text-4xl: 2.25rem;
        --text-5xl: 3rem;
        --text-6xl: 3.75rem;
        
        /* Spacing System */
        --space-1: 0.25rem;
        --space-2: 0.5rem;
        --space-3: 0.75rem;
        --space-4: 1rem;
        --space-5: 1.25rem;
        --space-6: 1.5rem;
        --space-8: 2rem;
        --space-10: 2.5rem;
        --space-12: 3rem;
        --space-16: 4rem;
        --space-20: 5rem;
        --space-24: 6rem;
        --space-32: 8rem;
        
        /* Border Radius */
        --radius-sm: 0.375rem;
        --radius: 0.5rem;
        --radius-md: 0.75rem;
        --radius-lg: 1rem;
        --radius-xl: 1.5rem;
        --radius-2xl: 2rem;
        --radius-3xl: 3rem;
        --radius-full: 9999px;
    }

    /* Global Styles */
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', 'Cantarell', sans-serif;
        font-feature-settings: "cv02", "cv03", "cv04", "cv11";
        line-height: 1.6;
        color: var(--gray-800);
        background: linear-gradient(135deg, var(--emerald-50) 0%, white 50%, var(--gray-50) 100%);
        min-height: 100vh;
        overflow-x: hidden;
    }

    /* Revolutionary Hero Section */
    .community-hero {
        background: var(--gradient-hero);
        position: relative;
        overflow: hidden;
        padding: var(--space-24) 0 var(--space-16);
        margin-bottom: var(--space-12);
    }

    .community-hero::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: 
            radial-gradient(circle at 20% 20%, rgba(110, 231, 183, 0.3) 0%, transparent 25%),
            radial-gradient(circle at 80% 80%, rgba(52, 211, 153, 0.2) 0%, transparent 25%),
            radial-gradient(circle at 40% 70%, rgba(16, 185, 129, 0.2) 0%, transparent 25%);
        animation: heroFloat 20s ease-in-out infinite;
    }

    @keyframes heroFloat {
        0%, 100% { transform: scale(1) rotate(0deg); }
        33% { transform: scale(1.05) rotate(1deg); }
        66% { transform: scale(0.98) rotate(-0.5deg); }
    }

    .hero-content {
        position: relative;
        z-index: 2;
        text-align: center;
        color: white;
    }

    .hero-badge {
        display: inline-flex;
        align-items: center;
        gap: var(--space-2);
        background: rgba(255, 255, 255, 0.15);
        backdrop-filter: blur(20px);
        border: 1px solid rgba(255, 255, 255, 0.2);
        border-radius: var(--radius-full);
        padding: var(--space-3) var(--space-6);
        font-size: var(--text-sm);
        font-weight: 600;
        margin-bottom: var(--space-8);
        box-shadow: var(--shadow-lg);
        animation: fadeInUp 0.8s ease-out;
    }

    .hero-title {
        font-size: clamp(2.5rem, 5vw, 4rem);
        font-weight: 900;
        line-height: 1.1;
        margin-bottom: var(--space-6);
        letter-spacing: -0.02em;
        animation: fadeInUp 0.8s ease-out 0.1s both;
    }

    .hero-subtitle {
        font-size: var(--text-xl);
        color: rgba(255, 255, 255, 0.9);
        max-width: 48rem;
        margin: 0 auto var(--space-10);
        line-height: 1.6;
        animation: fadeInUp 0.8s ease-out 0.2s both;
    }

    .hero-stats {
        display: flex;
        justify-content: center;
        gap: var(--space-12);
        margin-bottom: var(--space-8);
        animation: fadeInUp 0.8s ease-out 0.3s both;
    }

    .stat-item {
        text-align: center;
    }

    .stat-number {
        display: block;
        font-size: var(--text-3xl);
        font-weight: 900;
        margin-bottom: var(--space-1);
    }

    .stat-label {
        font-size: var(--text-sm);
        color: rgba(255, 255, 255, 0.8);
    }

    /* Advanced Layout System */
    .community-container {
        max-width: 1400px;
        margin: 0 auto;
        padding: 0 var(--space-8);
    }

    .community-layout {
        display: grid;
        grid-template-columns: 320px 1fr 280px;
        gap: var(--space-8);
        align-items: start;
    }

    /* Revolutionary Sidebar */
    .sidebar {
        position: sticky;
        top: var(--space-8);
        display: flex;
        flex-direction: column;
        gap: var(--space-6);
    }

    .sidebar-card {
        background: var(--gradient-surface);
        backdrop-filter: blur(20px);
        border: 1px solid var(--gray-200);
        border-radius: var(--radius-2xl);
        padding: var(--space-8);
        box-shadow: var(--shadow-lg);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .sidebar-card:hover {
        transform: translateY(-4px);
        box-shadow: var(--shadow-emerald);
        border-color: var(--emerald-200);
    }

    .sidebar-title {
        font-size: var(--text-lg);
        font-weight: 700;
        color: var(--gray-900);
        margin-bottom: var(--space-4);
        display: flex;
        align-items: center;
        gap: var(--space-2);
    }

    .sidebar-title i {
        color: var(--emerald-500);
    }

    /* Advanced Search & Filters */
    .search-section {
        background: var(--gradient-surface);
        backdrop-filter: blur(20px);
        border: 1px solid var(--gray-200);
        border-radius: var(--radius-2xl);
        padding: var(--space-8);
        box-shadow: var(--shadow-lg);
        margin-bottom: var(--space-8);
        position: relative;
        overflow: hidden;
    }

    .search-section::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--gradient-primary);
        transform: scaleX(0);
        transition: transform 0.3s ease;
    }

    .search-section:focus-within::before {
        transform: scaleX(1);
    }

    .search-header {
        display: flex;
        align-items: center;
        justify-content: space-between;
        margin-bottom: var(--space-6);
    }

    .search-title {
        font-size: var(--text-xl);
        font-weight: 700;
        color: var(--gray-900);
        display: flex;
        align-items: center;
        gap: var(--space-2);
    }

    .advanced-search-toggle {
        background: none;
        border: none;
        color: var(--emerald-600);
        font-size: var(--text-sm);
        font-weight: 600;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .advanced-search-toggle:hover {
        color: var(--emerald-700);
        transform: scale(1.05);
    }

    .search-form {
        display: grid;
        grid-template-columns: 1fr auto;
        gap: var(--space-4);
        align-items: end;
    }

    .search-input-group {
        position: relative;
    }

    .search-input {
        width: 100%;
        background: white;
        border: 2px solid var(--gray-200);
        border-radius: var(--radius-xl);
        padding: var(--space-4) var(--space-5) var(--space-4) var(--space-12);
        font-size: var(--text-base);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: var(--shadow-sm);
    }

    .search-input:focus {
        outline: none;
        border-color: var(--emerald-500);
        box-shadow: var(--shadow-emerald);
        transform: translateY(-2px);
    }

    .search-icon {
        position: absolute;
        left: var(--space-4);
        top: 50%;
        transform: translateY(-50%);
        color: var(--gray-400);
        font-size: var(--text-lg);
        transition: color 0.3s ease;
    }

    .search-input:focus + .search-icon {
        color: var(--emerald-500);
    }

    .search-btn {
        background: var(--gradient-primary);
        border: none;
        border-radius: var(--radius-xl);
        padding: var(--space-4) var(--space-8);
        color: white;
        font-weight: 600;
        font-size: var(--text-base);
        cursor: pointer;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: var(--shadow-md);
        display: flex;
        align-items: center;
        gap: var(--space-2);
        min-width: 120px;
        justify-content: center;
    }

    .search-btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-emerald);
    }

    .advanced-filters {
        display: none;
        grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
        gap: var(--space-4);
        margin-top: var(--space-6);
        padding-top: var(--space-6);
        border-top: 1px solid var(--gray-200);
    }

    .advanced-filters.show {
        display: grid;
        animation: fadeInDown 0.3s ease-out;
    }

    .filter-group {
        display: flex;
        flex-direction: column;
        gap: var(--space-2);
    }

    .filter-label {
        font-size: var(--text-sm);
        font-weight: 600;
        color: var(--gray-700);
        display: flex;
        align-items: center;
        gap: var(--space-1);
    }

    .filter-input, .filter-select {
        background: white;
        border: 2px solid var(--gray-200);
        border-radius: var(--radius-lg);
        padding: var(--space-3) var(--space-4);
        font-size: var(--text-sm);
        transition: all 0.3s ease;
    }

    .filter-input:focus, .filter-select:focus {
        outline: none;
        border-color: var(--emerald-500);
        box-shadow: 0 0 0 3px rgba(16, 185, 129, 0.1);
    }

    /* Revolutionary Action Bar */
    .action-bar {
        display: flex;
        align-items: center;
        justify-content: space-between;
        background: var(--gradient-surface);
        backdrop-filter: blur(20px);
        border: 1px solid var(--gray-200);
        border-radius: var(--radius-2xl);
        padding: var(--space-6);
        margin-bottom: var(--space-8);
        box-shadow: var(--shadow-md);
    }

    .view-controls {
        display: flex;
        align-items: center;
        gap: var(--space-4);
    }

    .view-toggle {
        display: flex;
        background: var(--gray-100);
        border-radius: var(--radius-lg);
        padding: var(--space-1);
    }

    .view-btn {
        background: none;
        border: none;
        padding: var(--space-2) var(--space-4);
        border-radius: var(--radius-md);
        color: var(--gray-600);
        cursor: pointer;
        transition: all 0.2s ease;
        display: flex;
        align-items: center;
        gap: var(--space-2);
    }

    .view-btn.active {
        background: white;
        color: var(--emerald-600);
        box-shadow: var(--shadow-sm);
    }

    .sort-dropdown {
        position: relative;
    }

    .sort-btn {
        background: white;
        border: 2px solid var(--gray-200);
        border-radius: var(--radius-lg);
        padding: var(--space-3) var(--space-5);
        color: var(--gray-700);
        cursor: pointer;
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: var(--space-2);
    }

    .sort-btn:hover {
        border-color: var(--emerald-300);
        transform: translateY(-1px);
    }

    .create-post-btn {
        background: var(--gradient-primary);
        border: none;
        border-radius: var(--radius-xl);
        padding: var(--space-4) var(--space-8);
        color: white;
        font-weight: 700;
        font-size: var(--text-base);
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: var(--space-2);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: var(--shadow-md);
        position: relative;
        overflow: hidden;
    }

    .create-post-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
        transition: left 0.6s ease;
    }

    .create-post-btn:hover {
        transform: translateY(-3px) scale(1.02);
        box-shadow: var(--shadow-emerald);
        color: white;
    }

    .create-post-btn:hover::before {
        left: 100%;
    }

    /* World-Class Post Cards */
    .posts-grid {
        display: grid;
        grid-template-columns: 1fr;
        gap: var(--space-8);
    }

    .post-card {
        background: var(--gradient-surface);
        backdrop-filter: blur(20px);
        border: 1px solid var(--gray-200);
        border-radius: var(--radius-2xl);
        overflow: hidden;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: var(--shadow-lg);
        position: relative;
        animation: fadeInUp 0.6s ease-out;
    }

    .post-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: var(--gradient-primary);
        transform: scaleX(0);
        transition: transform 0.4s ease;
    }

    .post-card:hover {
        transform: translateY(-8px);
        box-shadow: var(--shadow-emerald);
        border-color: var(--emerald-200);
    }

    .post-card:hover::before {
        transform: scaleX(1);
    }

    .post-header {
        padding: var(--space-8);
        display: flex;
        align-items: center;
        justify-content: space-between;
        border-bottom: 1px solid var(--gray-100);
    }

    .post-author {
        display: flex;
        align-items: center;
        gap: var(--space-4);
    }

    .author-avatar {
        width: 48px;
        height: 48px;
        border-radius: 50%;
        background: var(--gradient-primary);
        display: flex;
        align-items: center;
        justify-content: center;
        color: white;
        font-size: var(--text-lg);
        font-weight: 700;
        box-shadow: var(--shadow-md);
        position: relative;
        overflow: hidden;
    }

    .author-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 50%;
    }

    .author-info h4 {
        font-size: var(--text-lg);
        font-weight: 700;
        color: var(--gray-900);
        margin-bottom: var(--space-1);
    }

    .author-meta {
        font-size: var(--text-sm);
        color: var(--gray-600);
        display: flex;
        align-items: center;
        gap: var(--space-2);
    }

    .verified-badge {
        color: var(--emerald-500);
        font-size: var(--text-sm);
    }

    .post-menu {
        position: relative;
    }

    .menu-btn {
        background: none;
        border: none;
        color: var(--gray-400);
        font-size: var(--text-lg);
        cursor: pointer;
        padding: var(--space-2);
        border-radius: var(--radius);
        transition: all 0.2s ease;
    }

    .menu-btn:hover {
        background: var(--gray-100);
        color: var(--gray-600);
    }

    .post-content {
        padding: 0 var(--space-8) var(--space-6);
    }

    .post-title {
        font-size: var(--text-2xl);
        font-weight: 800;
        color: var(--gray-900);
        line-height: 1.3;
        margin-bottom: var(--space-4);
        cursor: pointer;
        transition: color 0.3s ease;
    }

    .post-title:hover {
        color: var(--emerald-600);
    }

    .post-excerpt {
        font-size: var(--text-base);
        color: var(--gray-700);
        line-height: 1.6;
        margin-bottom: var(--space-6);
        display: -webkit-box;
        -webkit-line-clamp: 3;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }

    .post-media {
        margin: var(--space-6) 0;
        border-radius: var(--radius-lg);
        overflow: hidden;
        position: relative;
    }

    .post-image {
        width: 100%;
        height: 300px;
        object-fit: cover;
        transition: transform 0.3s ease;
    }

    .post-card:hover .post-image {
        transform: scale(1.02);
    }

    .post-tags {
        display: flex;
        flex-wrap: wrap;
        gap: var(--space-2);
        margin-bottom: var(--space-6);
    }

    .tag {
        background: var(--emerald-50);
        color: var(--emerald-700);
        border: 1px solid var(--emerald-200);
        border-radius: var(--radius-full);
        padding: var(--space-1) var(--space-3);
        font-size: var(--text-xs);
        font-weight: 600;
        text-decoration: none;
        transition: all 0.2s ease;
        cursor: pointer;
    }

    .tag:hover {
        background: var(--emerald-100);
        color: var(--emerald-800);
        transform: translateY(-2px);
    }

    .post-actions {
        padding: var(--space-6) var(--space-8);
        background: var(--gray-50);
        border-top: 1px solid var(--gray-100);
        display: flex;
        align-items: center;
        justify-content: space-between;
    }

    .action-buttons {
        display: flex;
        gap: var(--space-6);
    }

    .action-btn {
        background: none;
        border: none;
        color: var(--gray-600);
        font-size: var(--text-sm);
        font-weight: 600;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: var(--space-2);
        padding: var(--space-2) var(--space-4);
        border-radius: var(--radius-lg);
        transition: all 0.2s ease;
    }

    .action-btn:hover {
        background: white;
        color: var(--emerald-600);
        transform: translateY(-1px);
    }

    .action-btn.liked {
        color: var(--red-500);
    }

    .action-btn.bookmarked {
        color: var(--yellow-500);
    }

    .read-more-btn {
        background: var(--gradient-secondary);
        border: none;
        border-radius: var(--radius-lg);
        padding: var(--space-3) var(--space-6);
        color: white;
        font-weight: 600;
        text-decoration: none;
        display: flex;
        align-items: center;
        gap: var(--space-2);
        transition: all 0.3s ease;
        box-shadow: var(--shadow-sm);
    }

    .read-more-btn:hover {
        transform: translateY(-2px);
        box-shadow: var(--shadow-md);
        color: white;
    }

    /* Trending Topics Sidebar */
    .trending-topics {
        list-style: none;
    }

    .trending-topic {
        display: flex;
        align-items: center;
        justify-content: space-between;
        padding: var(--space-3) 0;
        border-bottom: 1px solid var(--gray-100);
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .trending-topic:hover {
        padding-left: var(--space-2);
        color: var(--emerald-600);
    }

    .trending-topic:last-child {
        border-bottom: none;
    }

    .topic-info {
        display: flex;
        align-items: center;
        gap: var(--space-3);
    }

    .topic-rank {
        width: 24px;
        height: 24px;
        background: var(--emerald-100);
        color: var(--emerald-700);
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: var(--text-xs);
        font-weight: 700;
    }

    .topic-name {
        font-weight: 600;
        color: var(--gray-800);
    }

    .topic-count {
        font-size: var(--text-xs);
        color: var(--gray-500);
        font-weight: 500;
    }

    /* Community Stats */
    .stats-grid {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: var(--space-4);
    }

    .stat-card {
        text-align: center;
        padding: var(--space-4);
        background: var(--emerald-50);
        border-radius: var(--radius-lg);
        border: 1px solid var(--emerald-100);
    }

    .stat-number {
        font-size: var(--text-xl);
        font-weight: 900;
        color: var(--emerald-700);
        display: block;
        margin-bottom: var(--space-1);
    }

    .stat-label {
        font-size: var(--text-xs);
        color: var(--emerald-600);
        font-weight: 600;
    }

    /* Right Sidebar */
    .right-sidebar {
        display: flex;
        flex-direction: column;
        gap: var(--space-6);
    }

    /* Active Users */
    .active-users {
        list-style: none;
    }

    .active-user {
        display: flex;
        align-items: center;
        gap: var(--space-3);
        padding: var(--space-2) 0;
        cursor: pointer;
        transition: all 0.2s ease;
    }

    .active-user:hover {
        transform: translateX(4px);
    }

    .user-avatar {
        width: 32px;
        height: 32px;
        border-radius: 50%;
        background: var(--gradient-primary);
        color: white;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: var(--text-sm);
        font-weight: 600;
        position: relative;
    }

    .user-avatar img {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 50%;
    }

    .online-indicator {
        position: absolute;
        bottom: -2px;
        right: -2px;
        width: 12px;
        height: 12px;
        background: var(--emerald-400);
        border: 2px solid white;
        border-radius: 50%;
        box-shadow: var(--shadow-sm);
    }

    .user-name {
        font-weight: 600;
        color: var(--gray-800);
        font-size: var(--text-sm);
    }

    /* Empty State */
    .empty-state {
        text-align: center;
        padding: var(--space-20) var(--space-8);
        background: var(--gradient-surface);
        border: 1px solid var(--gray-200);
        border-radius: var(--radius-2xl);
        box-shadow: var(--shadow-lg);
    }

    .empty-icon {
        font-size: 4rem;
        color: var(--emerald-500);
        margin-bottom: var(--space-6);
        opacity: 0.8;
    }

    .empty-title {
        font-size: var(--text-2xl);
        font-weight: 800;
        color: var(--gray-900);
        margin-bottom: var(--space-4);
    }

    .empty-description {
        font-size: var(--text-lg);
        color: var(--gray-600);
        margin-bottom: var(--space-8);
        max-width: 400px;
        margin-left: auto;
        margin-right: auto;
    }

    /* Animations */
    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes fadeInDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes slideInRight {
        from {
            opacity: 0;
            transform: translateX(30px);
        }
        to {
            opacity: 1;
            transform: translateX(0);
        }
    }

    /* Responsive Design */
    @media (max-width: 1200px) {
        .community-layout {
            grid-template-columns: 280px 1fr;
        }
        
        .right-sidebar {
            display: none;
        }
    }

    @media (max-width: 768px) {
        .community-layout {
            grid-template-columns: 1fr;
        }
        
        .sidebar {
            position: static;
            order: 2;
        }
        
        .hero-stats {
            flex-direction: column;
            gap: var(--space-4);
        }
        
        .search-form {
            grid-template-columns: 1fr;
            gap: var(--space-4);
        }
        
        .action-bar {
            flex-direction: column;
            gap: var(--space-4);
            align-items: stretch;
        }
        
        .view-controls {
            justify-content: center;
        }
        
        .community-container {
            padding: 0 var(--space-4);
        }
    }

    @media (max-width: 640px) {
        .hero-title {
            font-size: 2rem;
        }
        
        .post-card {
            margin: 0 calc(var(--space-4) * -1);
            border-radius: 0;
            border-left: none;
            border-right: none;
        }
        
        .post-header,
        .post-content,
        .post-actions {
            padding-left: var(--space-4);
            padding-right: var(--space-4);
        }
    }
</style>

<!-- Revolutionary Hero Section -->
<section class="community-hero">
    <div class="community-container">
        <div class="hero-content">
            <div class="hero-badge">
                <i class="fas fa-users"></i>
                <span>Join Our Thriving Community</span>
            </div>
            
            <h1 class="hero-title">
                Healthcare Knowledge Hub
            </h1>
            
            <p class="hero-subtitle">
                Connect with medical professionals, share insights, ask questions, and stay updated 
                with the latest healthcare innovations from a global community of experts.
            </p>
            
            <div class="hero-stats">
                <div class="stat-item">
                    <span class="stat-number" data-count="15000">15,000+</span>
                    <span class="stat-label">Active Members</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" data-count="2500">2,500+</span>
                    <span class="stat-label">Expert Contributors</span>
                </div>
                <div class="stat-item">
                    <span class="stat-number" data-count="50000">50,000+</span>
                    <span class="stat-label">Knowledge Posts</span>
                </div>
            </div>
        </div>
    </div>
</section>

<div class="community-container">
    <!-- Advanced Search Section -->
    <div class="search-section">
        <div class="search-header">
            <h2 class="search-title">
                <i class="fas fa-search"></i>
                Discover Knowledge
            </h2>
            <button class="advanced-search-toggle" onclick="toggleAdvancedSearch()">
                <i class="fas fa-sliders-h"></i> Advanced Filters
            </button>
        </div>
        
        <form method="get" action="/posts" class="search-form" id="searchForm">
            <div class="search-input-group">
                <input
                    type="text"
                    name="q"
                    value="<%= (query && query.q) || '' %>"
                    class="search-input"
                    placeholder="Search posts, topics, or ask a question..."
                    autocomplete="off"
                />
                <i class="fas fa-search search-icon"></i>
            </div>
            <button type="submit" class="search-btn">
                <i class="fas fa-search"></i>
                <span>Search</span>
            </button>
        </form>
        
        <div class="advanced-filters" id="advancedFilters">
            <div class="filter-group">
                <label class="filter-label">
                    <i class="fas fa-tag"></i> Tags
                </label>
                <input
                    type="text"
                    name="tag"
                    value="<%= (query && query.tag) || '' %>"
                    class="filter-input"
                    placeholder="cardiology, nutrition..."
                />
            </div>
            <div class="filter-group">
                <label class="filter-label">
                    <i class="fas fa-folder"></i> Category
                </label>
                <select name="category" class="filter-select">
                    <option value="">All Categories</option>
                    <option value="research" <%= (query && query.category === 'research') ? 'selected' : '' %>>Research</option>
                    <option value="tips" <%= (query && query.category === 'tips') ? 'selected' : '' %>>Tips & Advice</option>
                    <option value="discussion" <%= (query && query.category === 'discussion') ? 'selected' : '' %>>Discussion</option>
                    <option value="case-study" <%= (query && query.category === 'case-study') ? 'selected' : '' %>>Case Studies</option>
                    <option value="news" <%= (query && query.category === 'news') ? 'selected' : '' %>>News</option>
                </select>
            </div>
            <div class="filter-group">
                <label class="filter-label">
                    <i class="fas fa-user-md"></i> Author Type
                </label>
                <select name="authorType" class="filter-select">
                    <option value="">All Authors</option>
                    <option value="doctor" <%= (query && query.authorType === 'doctor') ? 'selected' : '' %>>Doctors</option>
                    <option value="patient" <%= (query && query.authorType === 'patient') ? 'selected' : '' %>>Patients</option>
                    <option value="researcher" <%= (query && query.authorType === 'researcher') ? 'selected' : '' %>>Researchers</option>
                </select>
            </div>
            <div class="filter-group">
                <label class="filter-label">
                    <i class="fas fa-calendar"></i> Date Range
                </label>
                <select name="dateRange" class="filter-select">
                    <option value="">All Time</option>
                    <option value="today" <%= (query && query.dateRange === 'today') ? 'selected' : '' %>>Today</option>
                    <option value="week" <%= (query && query.dateRange === 'week') ? 'selected' : '' %>>This Week</option>
                    <option value="month" <%= (query && query.dateRange === 'month') ? 'selected' : '' %>>This Month</option>
                    <option value="year" <%= (query && query.dateRange === 'year') ? 'selected' : '' %>>This Year</option>
                </select>
            </div>
        </div>
    </div>

    <!-- Revolutionary Layout -->
    <div class="community-layout">
        <!-- Left Sidebar -->
        <aside class="sidebar">
            <!-- Community Stats -->
            <div class="sidebar-card">
                <h3 class="sidebar-title">
                    <i class="fas fa-chart-line"></i>
                    Community Stats
                </h3>
                <div class="stats-grid">
                    <div class="stat-card">
                        <span class="stat-number">1.2K</span>
                        <span class="stat-label">Today</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">8.5K</span>
                        <span class="stat-label">This Week</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">45K</span>
                        <span class="stat-label">This Month</span>
                    </div>
                    <div class="stat-card">
                        <span class="stat-number">320K</span>
                        <span class="stat-label">All Time</span>
                    </div>
                </div>
            </div>

            <!-- Trending Topics -->
            <div class="sidebar-card">
                <h3 class="sidebar-title">
                    <i class="fas fa-fire"></i>
                    Trending Topics
                </h3>
                <ul class="trending-topics">
                    <li class="trending-topic">
                        <div class="topic-info">
                            <div class="topic-rank">1</div>
                            <div>
                                <div class="topic-name">Mental Health</div>
                                <div class="topic-count">2.3K posts</div>
                            </div>
                        </div>
                    </li>
                    <li class="trending-topic">
                        <div class="topic-info">
                            <div class="topic-rank">2</div>
                            <div>
                                <div class="topic-name">COVID-19 Updates</div>
                                <div class="topic-count">1.8K posts</div>
                            </div>
                        </div>
                    </li>
                    <li class="trending-topic">
                        <div class="topic-info">
                            <div class="topic-rank">3</div>
                            <div>
                                <div class="topic-name">Nutrition Tips</div>
                                <div class="topic-count">1.5K posts</div>
                            </div>
                        </div>
                    </li>
                    <li class="trending-topic">
                        <div class="topic-info">
                            <div class="topic-rank">4</div>
                            <div>
                                <div class="topic-name">Cardiology</div>
                                <div class="topic-count">1.2K posts</div>
                            </div>
                        </div>
                    </li>
                    <li class="trending-topic">
                        <div class="topic-info">
                            <div class="topic-rank">5</div>
                            <div>
                                <div class="topic-name">Medical AI</div>
                                <div class="topic-count">950 posts</div>
                            </div>
                        </div>
                    </li>
                </ul>
            </div>

            <!-- Quick Actions -->
            <div class="sidebar-card">
                <h3 class="sidebar-title">
                    <i class="fas fa-bolt"></i>
                    Quick Actions
                </h3>
                <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                    <a href="/posts/new" class="create-post-btn" style="justify-content: center;">
                        <i class="fas fa-plus"></i>
                        New Post
                    </a>
                    <button class="search-btn" style="width: 100%; justify-content: center;" onclick="scrollToSearch()">
                        <i class="fas fa-search"></i>
                        Search Posts
                    </button>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main>
            <!-- Action Bar -->
            <div class="action-bar">
                <div class="view-controls">
                    <div class="view-toggle">
                        <button class="view-btn active" data-view="list">
                            <i class="fas fa-list"></i>
                            <span>List View</span>
                        </button>
                        <button class="view-btn" data-view="grid">
                            <i class="fas fa-th"></i>
                            <span>Grid View</span>
                        </button>
                    </div>
                    
                    <div class="sort-dropdown">
                        <button class="sort-btn">
                            <i class="fas fa-sort"></i>
                            <span>Latest Posts</span>
                            <i class="fas fa-chevron-down"></i>
                        </button>
                    </div>
                </div>
                
                <% if (user) { %>
                <a href="/posts/new" class="create-post-btn">
                    <i class="fas fa-plus"></i>
                    <span>Share Knowledge</span>
                </a>
                <% } else { %>
                <a href="/users/login" class="create-post-btn">
                    <i class="fas fa-sign-in-alt"></i>
                    <span>Login to Post</span>
                </a>
                <% } %>
            </div>

            <!-- Posts Content -->
            <div class="posts-grid" id="postsGrid">
                <% if (posts && posts.length > 0) { %>
                    <% posts.forEach((post, index) => { %>
                    <article class="post-card" style="animation-delay: <%= index * 0.1 %>s;">
                        <!-- Post Header -->
                        <div class="post-header">
                            <div class="post-author">
                                <div class="author-avatar">
                                    <% if (post.author && post.author.profilePicture) { %>
                                        <img src="<%= post.author.profilePicture %>" alt="<%= post.author.name %>" />
                                    <% } else { %>
                                        <%= (post.author && post.author.name) ? post.author.name.charAt(0).toUpperCase() : '👨‍⚕️' %>
                                    <% } %>
                                </div>
                                <div class="author-info">
                                    <h4>
                                        <%= (post.author && post.author.name) ? post.author.name : 'Anonymous User' %>
                                        <% if (post.author && post.author.isDoctor) { %>
                                            <i class="fas fa-check-circle verified-badge" title="Verified Medical Professional"></i>
                                        <% } %>
                                    </h4>
                                    <div class="author-meta">
                                        <span>
                                            <i class="fas fa-calendar-alt"></i>
                                            <%= new Date(post.createdAt).toLocaleDateString('en-US', { 
                                                year: 'numeric', 
                                                month: 'short', 
                                                day: 'numeric' 
                                            }) %>
                                        </span>
                                        <span>•</span>
                                        <span>
                                            <i class="fas fa-clock"></i>
                                            <%= Math.ceil(Math.random() * 5) + 2 %> min read
                                        </span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="post-menu">
                                <button class="menu-btn">
                                    <i class="fas fa-ellipsis-h"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Post Content -->
                        <div class="post-content">
                            <h2 class="post-title" onclick="location.href='/posts/<%= post._id %>'">
                                <%= post.title %>
                            </h2>
                            
                            <p class="post-excerpt">
                                <%= post.content ? post.content.substring(0, 200) + (post.content.length > 200 ? '...' : '') : 'Click to read the full article and discover valuable healthcare insights.' %>
                            </p>

                            <!-- Post Media -->
                            <% if (post.images && post.images.length > 0) { %>
                            <div class="post-media">
                                <img src="<%= post.images[0] %>" alt="<%= post.title %>" class="post-image" />
                            </div>
                            <% } %>

                            <!-- Tags -->
                            <% if (post.tags && post.tags.length > 0) { %>
                            <div class="post-tags">
                                <% post.tags.slice(0, 5).forEach(tag => { %>
                                <a href="/posts?tag=<%= encodeURIComponent(tag) %>" class="tag">
                                    #<%= tag %>
                                </a>
                                <% }) %>
                                <% if (post.tags.length > 5) { %>
                                <span class="tag" style="background: var(--gray-100); color: var(--gray-600);">
                                    +<%= post.tags.length - 5 %> more
                                </span>
                                <% } %>
                            </div>
                            <% } %>
                        </div>

                        <!-- Post Actions -->
                        <div class="post-actions">
                            <div class="action-buttons">
                                <button class="action-btn" data-action="like">
                                    <i class="fas fa-heart"></i>
                                    <span><%= Math.floor(Math.random() * 100) + 10 %></span>
                                </button>
                                <button class="action-btn" data-action="comment">
                                    <i class="fas fa-comment"></i>
                                    <span><%= Math.floor(Math.random() * 50) + 5 %></span>
                                </button>
                                <button class="action-btn" data-action="share">
                                    <i class="fas fa-share"></i>
                                    <span>Share</span>
                                </button>
                                <button class="action-btn" data-action="bookmark">
                                    <i class="fas fa-bookmark"></i>
                                    <span>Save</span>
                                </button>
                            </div>
                            
                            <a href="/posts/<%= post._id %>" class="read-more-btn">
                                <span>Read Full Article</span>
                                <i class="fas fa-arrow-right"></i>
                            </a>
                        </div>
                    </article>
                    <% }) %>
                <% } else { %>
                    <!-- Revolutionary Empty State -->
                    <div class="empty-state">
                        <div class="empty-icon">
                            <i class="fas fa-newspaper"></i>
                        </div>
                        <h3 class="empty-title">No Posts Found</h3>
                        <p class="empty-description">
                            <% if (query && (query.q || query.tag || query.category)) { %>
                                No posts match your search criteria. Try adjusting your filters or search terms.
                            <% } else { %>
                                Be the first to share valuable healthcare knowledge with our community!
                            <% } %>
                        </p>
                        <% if (user) { %>
                        <a href="/posts/new" class="create-post-btn">
                            <i class="fas fa-plus"></i>
                            <span>Create First Post</span>
                        </a>
                        <% } else { %>
                        <a href="/users/login" class="create-post-btn">
                            <i class="fas fa-sign-in-alt"></i>
                            <span>Login to Share</span>
                        </a>
                        <% } %>
                    </div>
                <% } %>
            </div>
        </main>

        <!-- Right Sidebar -->
        <aside class="right-sidebar">
            <!-- Active Users -->
            <div class="sidebar-card">
                <h3 class="sidebar-title">
                    <i class="fas fa-users"></i>
                    Active Now
                </h3>
                <ul class="active-users">
                    <li class="active-user">
                        <div class="user-avatar">
                            DM
                            <div class="online-indicator"></div>
                        </div>
                        <span class="user-name">Dr. Maria Santos</span>
                    </li>
                    <li class="active-user">
                        <div class="user-avatar">
                            JD
                            <div class="online-indicator"></div>
                        </div>
                        <span class="user-name">Dr. James Wilson</span>
                    </li>
                    <li class="active-user">
                        <div class="user-avatar">
                            SK
                            <div class="online-indicator"></div>
                        </div>
                        <span class="user-name">Sarah Kim</span>
                    </li>
                    <li class="active-user">
                        <div class="user-avatar">
                            AL
                            <div class="online-indicator"></div>
                        </div>
                        <span class="user-name">Dr. Alex Lee</span>
                    </li>
                    <li class="active-user">
                        <div class="user-avatar">
                            ER
                            <div class="online-indicator"></div>
                        </div>
                        <span class="user-name">Emma Rodriguez</span>
                    </li>
                </ul>
            </div>

            <!-- Featured Content -->
            <div class="sidebar-card">
                <h3 class="sidebar-title">
                    <i class="fas fa-star"></i>
                    Featured This Week
                </h3>
                <div style="display: flex; flex-direction: column; gap: var(--space-4);">
                    <div style="padding: var(--space-4); background: var(--emerald-50); border-radius: var(--radius-lg); border: 1px solid var(--emerald-100);">
                        <h4 style="font-size: var(--text-sm); font-weight: 700; color: var(--emerald-800); margin-bottom: var(--space-2);">
                            🏆 Top Contributor
                        </h4>
                        <p style="font-size: var(--text-xs); color: var(--emerald-700);">
                            Dr. Sarah Mitchell for exceptional mental health insights
                        </p>
                    </div>
                    <div style="padding: var(--space-4); background: var(--blue-50); border-radius: var(--radius-lg); border: 1px solid var(--blue-200);">
                        <h4 style="font-size: var(--text-sm); font-weight: 700; color: var(--blue-800); margin-bottom: var(--space-2);">
                            📚 Most Read
                        </h4>
                        <p style="font-size: var(--text-xs); color: var(--blue-700);">
                            "Revolutionary AI in Medical Diagnosis" - 15K views
                        </p>
                    </div>
                </div>
            </div>

            <!-- Quick Links -->
            <div class="sidebar-card">
                <h3 class="sidebar-title">
                    <i class="fas fa-external-link-alt"></i>
                    Quick Links
                </h3>
                <div style="display: flex; flex-direction: column; gap: var(--space-3);">
                    <a href="/doctors" style="color: var(--gray-700); text-decoration: none; font-weight: 500; display: flex; align-items: center; gap: var(--space-2); transition: color 0.2s ease;" onmouseover="this.style.color='var(--emerald-600)'" onmouseout="this.style.color='var(--gray-700)'">
                        <i class="fas fa-user-md"></i>
                        Find Doctors
                    </a>
                    <a href="/prediction/xray" style="color: var(--gray-700); text-decoration: none; font-weight: 500; display: flex; align-items: center; gap: var(--space-2); transition: color 0.2s ease;" onmouseover="this.style.color='var(--emerald-600)'" onmouseout="this.style.color='var(--gray-700)'">
                        <i class="fas fa-brain"></i>
                        AI Analysis
                    </a>
                    <a href="/video-calls" style="color: var(--gray-700); text-decoration: none; font-weight: 500; display: flex; align-items: center; gap: var(--space-2); transition: color 0.2s ease;" onmouseover="this.style.color='var(--emerald-600)'" onmouseout="this.style.color='var(--gray-700)'">
                        <i class="fas fa-video"></i>
                        Telemedicine
                    </a>
                    <a href="/emergency" style="color: var(--gray-700); text-decoration: none; font-weight: 500; display: flex; align-items: center; gap: var(--space-2); transition: color 0.2s ease;" onmouseover="this.style.color='var(--red-600)'" onmouseout="this.style.color='var(--gray-700)'">
                        <i class="fas fa-exclamation-triangle"></i>
                        Emergency
                    </a>
                </div>
            </div>
        </aside>
    </div>
</div>

<!-- Revolutionary JavaScript -->
<script>
    // Advanced Search Toggle
    function toggleAdvancedSearch() {
        const filters = document.getElementById('advancedFilters');
        const button = document.querySelector('.advanced-search-toggle');
        
        filters.classList.toggle('show');
        
        if (filters.classList.contains('show')) {
            button.innerHTML = '<i class="fas fa-times"></i> Hide Filters';
        } else {
            button.innerHTML = '<i class="fas fa-sliders-h"></i> Advanced Filters';
        }
    }

    // Scroll to Search
    function scrollToSearch() {
        document.querySelector('.search-section').scrollIntoView({ behavior: 'smooth' });
        document.querySelector('.search-input').focus();
    }

    // View Toggle
    document.querySelectorAll('.view-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.view-btn').forEach(b => b.classList.remove('active'));
            this.classList.add('active');
            
            const grid = document.getElementById('postsGrid');
            const view = this.dataset.view;
            
            if (view === 'grid') {
                grid.style.gridTemplateColumns = 'repeat(auto-fit, minmax(400px, 1fr))';
                grid.style.gap = 'var(--space-6)';
            } else {
                grid.style.gridTemplateColumns = '1fr';
                grid.style.gap = 'var(--space-8)';
            }
        });
    });

    // Post Actions
    document.querySelectorAll('.action-btn').forEach(btn => {
        btn.addEventListener('click', function(e) {
            e.preventDefault();
            const action = this.dataset.action;
            
            switch(action) {
                case 'like':
                    this.classList.toggle('liked');
                    const likeCount = this.querySelector('span');
                    const currentCount = parseInt(likeCount.textContent);
                    likeCount.textContent = this.classList.contains('liked') ? 
                        currentCount + 1 : currentCount - 1;
                    break;
                    
                case 'bookmark':
                    this.classList.toggle('bookmarked');
                    break;
                    
                case 'share':
                    if (navigator.share) {
                        navigator.share({
                            title: 'Healthfy Community Post',
                            text: 'Check out this healthcare knowledge post',
                            url: window.location.href
                        });
                    } else {
                        navigator.clipboard.writeText(window.location.href);
                        this.innerHTML = '<i class="fas fa-check"></i><span>Copied!</span>';
                        setTimeout(() => {
                            this.innerHTML = '<i class="fas fa-share"></i><span>Share</span>';
                        }, 2000);
                    }
                    break;
            }
        });
    });

    // Enhanced Search
    const searchForm = document.getElementById('searchForm');
    const searchInput = document.querySelector('.search-input');
    
    // Auto-complete suggestions (mock data)
    const suggestions = [
        'mental health tips', 'cardiology research', 'nutrition advice',
        'medical AI updates', 'telemedicine best practices', 'patient care',
        'preventive medicine', 'healthcare technology', 'medical education'
    ];
    
    searchInput.addEventListener('input', function() {
        // Add your auto-complete logic here
        console.log('Searching for:', this.value);
    });

    // Smooth animations
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -50px 0px'
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.opacity = '1';
                entry.target.style.transform = 'translateY(0)';
            }
        });
    }, observerOptions);

    // Observe all post cards
    document.querySelectorAll('.post-card').forEach(card => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(30px)';
        card.style.transition = 'all 0.6s cubic-bezier(0.4, 0, 0.2, 1)';
        observer.observe(card);
    });

    // Counter animation for hero stats
    function animateCounters() {
        document.querySelectorAll('[data-count]').forEach(counter => {
            const target = parseInt(counter.dataset.count);
            const duration = 2000;
            const step = target / (duration / 16);
            let current = 0;
            
            const timer = setInterval(() => {
                current += step;
                if (current >= target) {
                    current = target;
                    clearInterval(timer);
                }
                counter.textContent = Math.floor(current).toLocaleString() + '+';
            }, 16);
        });
    }

    // Initialize animations
    document.addEventListener('DOMContentLoaded', function() {
        setTimeout(animateCounters, 500);
        
        // Initialize tooltips and other interactive elements
        initializeInteractivity();
    });

    function initializeInteractivity() {
        // Add hover effects to trending topics
        document.querySelectorAll('.trending-topic').forEach(topic => {
            topic.addEventListener('click', function() {
                const topicName = this.querySelector('.topic-name').textContent;
                window.location.href = `/posts?q=${encodeURIComponent(topicName)}`;
            });
        });

        // Add click handlers for active users
        document.querySelectorAll('.active-user').forEach(user => {
            user.addEventListener('click', function() {
                console.log('User clicked:', this.querySelector('.user-name').textContent);
            });
        });
    }

    // Performance optimization
    let ticking = false;
    
    function updateScrollEffects() {
        const scrolled = window.pageYOffset;
        const rate = scrolled * -0.5;
        
        // Parallax effect for hero
        const hero = document.querySelector('.community-hero');
        if (hero) {
            hero.style.transform = `translateY(${rate}px)`;
        }
        
        ticking = false;
    }

    window.addEventListener('scroll', function() {
        if (!ticking) {
            requestAnimationFrame(updateScrollEffects);
            ticking = true;
        }
    });

    // Keyboard shortcuts
    document.addEventListener('keydown', function(e) {
        // Ctrl/Cmd + K to focus search
        if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
            e.preventDefault();
            document.querySelector('.search-input').focus();
        }
        
        // Escape to close advanced filters
        if (e.key === 'Escape') {
            const filters = document.getElementById('advancedFilters');
            if (filters.classList.contains('show')) {
                toggleAdvancedSearch();
            }
        }
    });
</script>